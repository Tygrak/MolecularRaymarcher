<!DOCTYPE html>
<head>
   <meta charset="utf-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <title>WebGPU</title>
   <meta name="description" content="">
   <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
   <div class="grid">
      <div class="item1">
         <!--<h1>WebGPU</h1><br>-->
         <div>
            <label><input id="renderOnlyMovementCheckbox" type="checkbox" name="options" value="fixed" checked>Render Only On Movement</label>
            <br>
            <label><input id="alwaysFullRenderCheckbox" type="checkbox" name="options" value="fixed" checked>Always Full Render</label>
            <br>
            <label style="display: none;"><input id="getRaymarchNeighborsCheckbox" type="checkbox" name="options" value="fixed">Get Raymarch Cell Neighbors</label>
         </div>
         <!--<br>-->
         <div class="slidecontainer" style="display: none;">
            <label><input type="range" min="1" max="100" step="0.1" value="100" class="slider" id="sliderPercentageShown">Percentage Shown</label>
         </div>
         <div>
            <label>
               <select id="dataSelection" name="dataSelection" style="width: 8rem;">
                  <option value="1cqw">1cqw</option>
                  <option value="1aon">1aon</option>
                  <option value="dataFile">Data File</option>
               </select>
               Structure
            </label>
         </div>
         <div>
            <button id="dataLoadButton">Load Data</button>
            <input type="file" id="dataFileInput" name="dataFileInput" accept=".data,.txt,.pdb,.pdb1,.pdb2,.pcd,.obj">
         </div>      
         <div>
            <label>
               <select id="visualizationSelection" name="visualizationSelection" style="width: 8rem;">
                  <option selected value="raymarchoctree">RaymarchOct</option>
                  <option value="impostor">Impostor</option>
                  <!-- 
                  <option value="raymarch">Raymarch</option>
                  <option value="raytrace">Raytrace</option>
                  -->
                  <option value="basic">Basic</option>
               </select>
               Visualization Mode
            </label>
         </div>
         <div>
            <label>
               <select id="debugSelection" name="debugSelection" style="width: 8rem;">
                  <option selected value="0">Default</option>
                  <option value="1">DefaultWithBase</option>
                  <option value="2">SemiLit</option>
                  <option value="3">Lit</option>
                  <option value="4">LitGooch</option>
                  <option value="5">LitSpecular</option>
                  <option value="6">SemiLitWithBase</option>
                  <option value="301">Transparent1</option>
                  <option value="302">Transparent2</option>
                  <option value="303">Transparent3</option>
                  <option value="304">TransparentDistance</option>
                  <option value="305">TransparentConst</option>
                  <option value="306">TransparentFake</option>
                  <option value="307">TransparentFake2</option>
                  <option value="101">Normals</option>
                  <option value="102">Depth</option>
                  <option value="105">FirstStepDistance</option>
                  <option value="106">AllStepsDistance</option>
                  <option value="107">T/End</option>
                  <option value="108">RaymarchedAtoms</option>
                  <option value="103">Iterations</option>
                  <option value="104">CellsRaymarched</option>
                  <option value="150">SminBoundaries</option>
                  <option value="111">Octree1</option>
                  <option value="112">Octree2</option>
                  <option value="113">Octree3</option>
                  <option value="118">ClosestOctree</option>
                  <option value="119">Debug</option>
                  <option value="139">SkipRCellPos0</option>

                  <option value="130">BlankRCellPos0</option>
                  <option value="131">BlankRCellPos1</option>
                  <option value="132">BlankRCellPos2</option>
                  <option value="133">BlankRCellPos3</option>
                  <option value="134">BlankRCellPos4</option>
                  <option value="135">BlankRCellPos5</option>
                  <option value="136">BlankRCellPos6</option>
                  <option value="137">BlankRCellPos7</option>
               </select>
               Debug Mode
            </label>
         </div>
         <div class="slidecontainer">
            <label><input type="range" min="1" max="100" step="0.1" value="50" class="slider" id="raymarchingDrawnAmount">Debug A</label>
         </div>
         <div class="slidecontainer">
            <label><input type="range" min="0" max="100" step="0.1" value="80" class="slider" id="raymarchingStartPosition">Debug B</label>
         </div>
         <br>
         <div class="slidecontainer">
            <label><input type="range" min="0.1" max="2.5" step="0.1" value="1" class="slider" id="impostorSizeScale">Atom Size Scale</label>
         </div>
         <div class="slidecontainer">
            <label><input type="range" min="0.01" max="3.0" step="0.05" value="0.8" class="slider" id="kSmoothminScale">Smoothmin k</label>
         </div>
         <div class="slidecontainer">
            <label><input type="range" min="0" max="1" step="0.001" value="0" class="slider" id="lightRotation">Light Rotation</label>
         </div>
         <div>
            <button id="benchmarkButton">Run Benchmark</button>
         </div> 
         <div>
            <button id="regenerateOctreeButton">Regenerate Octree</button>
         </div> 
         <br>  
         <div>
            <p id="fpsCounter">10fps</p>
         </div>
         <!--Todo: make this stick to bottom of page instead of this hack-->
         <br>  
         <div>
            <button class="collapsible" onclick="ToggleAdditionalOptions(this)">Additional Options</button>
            <div class="content" id="additionalOptions">
               <label>
                  <select id="smoothminSelection" name="smoothminSelection" style="width: 8rem;">
                     <option value="UseSmoothMinExp">Exponential</option>
                     <option value="UseSmoothMinPower">Power</option>
                     <option value="UseSmoothMinRoot">Root</option>
                     <option selected value="UseSmoothMinPoly1">Polynomial1</option>
                     <option selected value="UseSmoothMinPoly2">Polynomial2</option>
                  </select>
                  Smoothmin Type
               </label>
               <br>
               <label><input id="highlightMainChainCheckbox" type="checkbox" name="options" value="fixed" checked>Highlight Main Chain</label>
               <br>
               <label><input id="allowResetRaymarchCheckbox" type="checkbox" name="options" value="fixed" checked>Allow Reset Raymarch</label>
               <br>
               <label><input id="raytraceAtomsOptimCheckbox" type="checkbox" name="options" value="fixed" checked>Raytrace Atoms Optim</label>
               <br>
               <label><input id="skipUsingRealHitOptimCheckbox" type="checkbox" name="options" value="fixed" checked>Skip Using Realhit Optim</label>
               <br>
               <label><input id="makeKdOctreeCheckbox" type="checkbox" name="options" value="fixed" checked>Make Kd-Esque Octree</label>
               <br>
               <label><input id="makeIrregularOctreeCheckbox" type="checkbox" name="options" value="fixed" checked>Make Irregular Octree</label>
               <br>
               <label><input id="automaticOctreeSizeCheckbox" type="checkbox" name="options" value="fixed" checked>Automatic Octree Size</label>
               <br>
               <label><input id="cartoonEdgesCheckbox" type="checkbox" name="options" value="fixed">Cartoon Edges</label>
               <br>
               <label><input id="colorUsingChainCheckbox" type="checkbox" name="options" value="fixed">Color By Chain Number</label>
               <br>
               <label><input id="centerDistanceFadeCheckbox" type="checkbox" name="options" value="fixed">Center Distance Fade</label>
               <br>
               <div class="slidecontainer">
                  <label><input type="range" min="2" max="6" step="1" value="4" class="slider" id="octreeLayers">Octree Layers</label>
               </div>
               <label>
                  <input id="benchmarkDistance" type="number" min="0" max="10000" step="0.01" name="options" value="0.0">
                  Benchmark Distance
               </label>
               <br>
               <label><input id="canvasSizeCheckbox" type="checkbox" name="options" value="fixed">Use Fixed Canvas Size</label>
               <br>    
               <label>
                  <input id="fixedCanvasX" type="number" min="0" max="10000" step="0.01" name="options" value="960.0" class="mediumNumber">
                  <input id="fixedCanvasY" type="number" min="0" max="10000" step="0.01" name="options" value="920.0" class="mediumNumber">
                  Fixed Canvas Size
               </label>
               <br>    
               <input type="file" id="shaderFileInput" name="shaderFileInput" accept=".wgsl">
               <br>  
               <!-- Todo: allow reloading utilities file too?
               Utilities
               <br>  
               <input type="file" id="shaderUtilitiesFileInput" name="shaderUtilitiesFileInput" accept=".wgsl">
               -->
               <label>
                  <input id="preprocessorFlags" type="text" name="options" value="" style="width: 7.5rem">
                  Preprocessor Flags
               </label>
               <br>  
               <button id="shaderLoadButton">Shader Reload</button>
               <button class="collapsible" onclick="ToggleColorOptions(this)">Color Options</button>
               <div class="content" id="colorOptions">
                  <label><input id="addDebugColormapCheckbox" type="checkbox" name="options" value="fixed">Add Debug Colormap</label>
                  <br>
                  <label>
                     <input id="CAtomColorR" type="number" min="0" max="1" step="0.01" name="options" value="0.6" class="smallNumber">
                     <input id="CAtomColorG" type="number" min="0" max="1" step="0.01" name="options" value="0.9" class="smallNumber">
                     <input id="CAtomColorB" type="number" min="0" max="1" step="0.01" name="options" value="0.3" class="smallNumber">
                     RGB for C
                  </label>
                  <br>
                  <label>
                     <input id="NAtomColorR" type="number" min="0" max="1" step="0.01" name="options" value="0.95" class="smallNumber">
                     <input id="NAtomColorG" type="number" min="0" max="1" step="0.01" name="options" value="0.05" class="smallNumber">
                     <input id="NAtomColorB" type="number" min="0" max="1" step="0.01" name="options" value="0.25" class="smallNumber">
                     RGB for N
                  </label>
                  <br>
                  <label>
                     <input id="OAtomColorR" type="number" min="0" max="1" step="0.01" name="options" value="0.2" class="smallNumber">
                     <input id="OAtomColorG" type="number" min="0" max="1" step="0.01" name="options" value="0.05" class="smallNumber">
                     <input id="OAtomColorB" type="number" min="0" max="1" step="0.01" name="options" value="0.95" class="smallNumber">
                     RGB for O
                  </label>
                  <br>
                  <label>
                     <input id="SAtomColorR" type="number" min="0" max="1" step="0.01" name="options" value="0.995" class="smallNumber">
                     <input id="SAtomColorG" type="number" min="0" max="1" step="0.01" name="options" value="0.995" class="smallNumber">
                     <input id="SAtomColorB" type="number" min="0" max="1" step="0.01" name="options" value="0.025" class="smallNumber">
                     RGB for S
                  </label>
                  <br>
                  <label>
                     <input id="BgColorR" type="number" min="0" max="1" step="0.01" name="options" value="0.15" class="smallNumber">
                     <input id="BgColorG" type="number" min="0" max="1" step="0.01" name="options" value="0.0" class="smallNumber">
                     <input id="BgColorB" type="number" min="0" max="1" step="0.01" name="options" value="0.15" class="smallNumber">
                     RGB for Bg
                  </label>
                  <br>
               </div>
               <!--<button class="collapsible" onclick="ToggleBenchmarkOptions(this)">Benchmark Options</button>
               <div class="content" id="benchmarkOptions">
                  
               </div>-->
               <button id="createUrlButton">Create Url</button>
               <div>
                  <p id="urlResult"></p>
               </div>
            </div>
         </div>  
      </div>
      <div class="item2" style="user-select: none;">
         <canvas id="canvas-webgpu" style="max-width: 800;"></canvas>
      </div>
   </div>

   <script src="main.bundle.js"></script>
   <script>
      function ToggleAdditionalOptions(button){
         button.classList.toggle('active');
         let content = document.getElementById("additionalOptions");
         content.classList.toggle("opened");
      };
      
      function ToggleColorOptions(button){
         button.classList.toggle('active');
         let content = document.getElementById("colorOptions");
         content.classList.toggle("opened");
      };
      
      function ToggleBenchmarkOptions(button){
         button.classList.toggle('active');
         let content = document.getElementById("benchmarkOptions");
         content.classList.toggle("opened");
      };
   </script>
</body>
</html>